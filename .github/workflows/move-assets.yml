
name: Move Assets to Tag

on:
  push:
    tags:
    - '*'

jobs:
  build_executable:
    runs-on: ubuntu-latest

    steps:
    - name: Fetch Windows exe
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-windows.yml
        name: nlpw.exe

    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./nlpw.exe"
        asset_name: "nlpw.exe"

    - name: Fetch Windows icu1
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-windows.yml
        name: "icudt71.dll"

    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./icudt71.dll"
        asset_name: "icudt71.dll"

    - name: Fetch Windows icu2
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-windows.yml
        name: "libicuuc.a.dll"
        
    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./libicuuc.a.dll"
        asset_name: "libicuuc.a.dll"

    - name: Fetch Linux exe
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-linux.yml
        name: nlpl.exe
                
    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./nlpl.exe"
        asset_name: "nlpl.exe"

    - name: Fetch Linux icu1
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-linux.yml
        name: "libicutu.a"
                        
    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./libicutu.a"
        asset_name: "libicutu.a"

    - name: Fetch Linux icu2
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-linux.yml
        name: "libicuuc.a"
                                
    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./libicuuc.a"
        asset_name: "libicuuc.a"
        
    - name: Fetch MacOS exe
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-macos.yml
        name: nlpm.exe
                                        
    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./nlpm.exe"
        asset_name: "nlpm.exe"

    - name: Fetch MacOS icu1
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-macos.yml
        name: "libicutum.a"
                                                
    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./libicutum.a"
        asset_name: "libicutum.a"

    - name: Fetch MacOS icu2
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-macos.yml
        name: "libicuucm.a"
                                                        
    - uses: shogo82148/actions-upload-release-asset@v1
      with:
        upload_url: ${{ steps.create_release.outputs.upload_url }}
        asset_path: "./libicuucm.a"
        asset_name: "libicuucm.a"

    - name: Fetch Engine Files
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-enginefiles.yml
        name: "nlpengine"
                                                                
    - uses: fnkr/github-action-ghr@v1
      if: startsWith(github.ref, 'refs/tags/')
      env:
        GHR_PATH: visualtext.zip
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    - name: Fetch VisualText Files
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build-visualfiles.yml
        name: "visualtext"

    - uses: fnkr/github-action-ghr@v1
      if: startsWith(github.ref, 'refs/tags/')
      env:
        GHR_PATH: visualtext.zip
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}